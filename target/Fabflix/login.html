<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Login to Fabflix</title>
    <script>
        function handleLogin(event) {
            event.preventDefault();
            var form = document.getElementById('loginForm');
            var formData = new FormData(form);

            var contextPath = getContextPath(); // Get the context path dynamically

            fetch('/Fabflix', { // Construct the URL using the context path
                method: 'POST',
                body: formData
            })
                .then(response => {
                    console.log(response); // Log the response object to the console
                    if (response.status === 200) {
                        alert('Credentials verified!');
                        // window.location.href = response.url;
                        window.location.href = '/Fabflix/searchandbrowsepage.html'
                    } else {
                        return response.text();
                        window.location.href = '/Fabflix/login.html'
                    }
                })
                .then(text => {
                    // Handle any messages sent by the servlet
                    if (text) {
                        document.getElementById('loginError').innerText = text;
                    }
                })
                .catch(error => {
                    document.getElementById('loginError').innerText = error.message;
                });
        }

        function getContextPath() {
            var pathArray = window.location.pathname.split('/');
            // Correct the context path retrieval logic if necessary
            var contextPath = "/" + pathArray[1];
            return contextPath;
        }

    </script>

</head>

<body>s
    <h2>Welcome to Fabflix</h2>
    <form id="loginForm" action="/Fablix" method="post"  novalidate>
        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <div>
            <button type="submit">Login</button>
        </div>
        <div id="loginError" style="color: red;"></div>
    </form>
</body>

</html>

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->

<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Login to Fabflix</title>-->
<!--</head>-->

<!--<body>-->
<!--<h2>Welcome to Fabflix</h2>-->
<!--<form id="loginForm" action="/Fablix" method="post" novalidate>-->
<!--    <div>-->
<!--        <label for="email">Email:</label>-->
<!--        <input type="email" id="email" name="email" required>-->
<!--    </div>-->
<!--    <div>-->
<!--        <label for="password">Password:</label>-->
<!--        <input type="password" id="password" name="password" required>-->
<!--    </div>-->
<!--    <div>-->
<!--        <button type="submit">Login</button>-->
<!--    </div>-->
<!--</form>-->
<!--</body>-->

<!--</html>-->
